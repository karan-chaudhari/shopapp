{% extends 'shop/layout.html' %}
{% load static %}
{% block title %}{{i.product_name}} - Divisima{% endblock %}
{% block content %}
<!-- product section -->
<section class="product-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="product-pic-zoom">
                    {% if fprod.img %}
                    <div id="imgpr{{fprod.id}}">
                        <img class="product-big-img" src="{{fprod.img.url}}" alt=""></div>
                    {% else %}
                    <div id="imgpr{{i.id}}">
                        <img class="product-big-img" src="{{i.img.url}}" alt=""></div>
                    {% endif %}
                </div>
            </div>
            <div class="col-lg-6 product-details">
                {% if fprod.product_name %}
                <h2 id="namepr{{fprod.id}}" class="p-title">{{fprod.product_name}}</h2>
                <h3 id="pricepr{{fprod.id}}" class="p-price">{{fprod.price}}</h3>
                {% else %}
                <h2 id="namepr{{i.id}}" class="p-title">{{i.product_name}}</h2>
                <h3 id="pricepr{{i.id}}" class="p-price">{{i.price}}</h3>
                {% endif %}
                <h4 class="p-stock">Available: <span>In Stock</span></h4>
                <div class="p-rating">
                    <i class="fa fa-star-o"></i>
                    <i class="fa fa-star-o"></i>
                    <i class="fa fa-star-o"></i>
                    <i class="fa fa-star-o"></i>
                    <i class="fa fa-star-o fa-fade"></i>
                </div>
                <div class="p-review">
                    <a href="">3 reviews</a>|<a href="">Add your review</a>
                </div>
                <div class="fw-size-choose">
                    <p>Size</p>
                    {% if i.cate == 'Shoes' or fprod.cate == 'Shoes' %}
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size">
                        <label for="xs-size">6</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size" checked="">
                        <label for="xs-size">7</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size">
                        <label for="xs-size">8</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size">
                        <label for="xs-size">9</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size">
                        <label for="xs-size">10</label>
                    </div>
                    {% else %}
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xs-size">
                        <label for="xs-size">32</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="s-size">
                        <label for="s-size">34</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="m-size" checked="">
                        <label for="m-size">36</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="l-size">
                        <label for="l-size">38</label>
                    </div>
                    <div class="sc-item disable">
                        <input type="radio" name="sc" id="xl-size" disabled>
                        <label for="xl-size">40</label>
                    </div>
                    <div class="sc-item">
                        <input type="radio" name="sc" id="xxl-size">
                        <label for="xxl-size">42</label>
                    </div>
                    {% endif %}
                </div>
                {% if i.id %}
                <span id="divpr{{i.id}}" class="proddiv">
                    <button id="pr{{i.id}}" class="site-btn prodcart">Add to Cart</button>
                </span>
                {% elif fprod.id %}
                <span id="divpr{{fprod.id}}" class="proddiv">
                    <button id="pr{{fprod.id}}" class="site-btn prodcart">ADD TO CART</button>
                </span>
                {% endif %}
                <a href="/shop/cart/"><button class="site-btn my-2">Go to cart</button></a>
                <div id="accordion" class="accordion-area">
                    <div class="panel">
                        <div class="panel-header" id="headingOne">
                            {% if i.desc or fprod.desc %}
                            <button class="panel-link active" data-toggle="collapse" data-target="#collapse1" aria-expanded="true" aria-controls="collapse1">description</button>
                        </div>
                        <div id="collapse1" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                            <div class="panel-body">
                                {% if i.desc %}
                                <pre style="white-space: pre-line;">{{i.desc}}</pre>
                                {% elif fprod.desc %}
                                <pre style="white-space: pre-line;">{{fprod.desc}}</pre>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    <div class="panel">
                        <div class="panel-header" id="headingTwo">
                            <button class="panel-link" data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapse2">card details </button>
                        </div>
                        <div id="collapse2" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                            <div class="panel-body">
                                <img src="{% static './img/cards.png' %}" alt="">
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin pharetra tempor so dales. Phasellus sagittis auctor gravida. Integer bibendum sodales arcu id te mpus. Ut consectetur lacus leo, non scelerisque nulla euismod nec.</p>
                            </div>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-header" id="headingThree">
                            <button class="panel-link" data-toggle="collapse" data-target="#collapse3" aria-expanded="false" aria-controls="collapse3">shipping & Returns</button>
                        </div>
                        <div id="collapse3" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
                            <div class="panel-body">
                                <h4>7 Days Returns</h4>
                                <p>Cash on Delivery Available<br>Home Delivery <span>3 - 4 days</span></p>
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin pharetra tempor so dales. Phasellus sagittis auctor gravida. Integer bibendum sodales arcu id te mpus. Ut consectetur lacus leo, non scelerisque nulla euismod nec.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- product section end -->
{% endblock %}
{% block js %}
<script>
var id = "pr{{i.id}}";
let keycart = Object.keys(cart);

var found = keycart.find(function(element) {
    return element == id;
});

if (found != undefined) {
    document.getElementById('div' + id).innerHTML = "<button id='minus" + id + "' class='quantity-btn minus'>-</button><span id='val" + id + "'>" + cart[id][0] + "</span><button id='plus" + id + "' class='quantity-btn plus'>+</button>";
}

$('.proddiv').on("click", "button.minus", function() {
    a = this.id.slice(7, );
    cart['pr' + a][0] = cart['pr' + a][0] - 1;
    cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
    if (cart['pr' + a][0] == 0) {
        document.getElementById('divpr' + a).innerHTML = "<button id='pr" + a + "' class='site-btn prodcart'>Add to Cart</button>";
        delete cart['pr' + a];
    } else {
        document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    }
    updateprodcart();
});

$('.proddiv').on("click", "button.plus", function() {
    a = this.id.slice(6, );
    cart['pr' + a][0] = cart['pr' + a][0] + 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateprodcart();
});

$('.proddiv').on('click', 'button.prodcart', function() {
    var idstr = this.id.toString();
    if (cart[idstr] != undefined) {
        qty = cart[idstr][0] + 1;
    } else {
        qty = 1;
        name = document.getElementById('name' + idstr).innerHTML;
        price = document.getElementById('price' + idstr).innerHTML;
        img = document.getElementById('img' + idstr).innerHTML;
        cart[idstr] = [qty, name, price, img];
    }
    document.getElementById('div' + idstr).innerHTML = "<button id='minus" + idstr + "' class='quantity-btn minus'>-</button><span id='val" + idstr + "'>" + cart[idstr][0] + "</span><button id='plus" + idstr + "' class='quantity-btn plus'>+</button>";
    updateprodcart();
});

function updateprodcart() {
    localStorage.setItem('cart', JSON.stringify(cart));
    document.getElementById('cart').innerHTML = Object.keys(cart).length;
}

document.getElementById('cart').innerHTML = Object.keys(cart).length;
</script>
{% endblock %}